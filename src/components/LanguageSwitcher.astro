---
import { translations } from '../i18n/translations';
---
<div id="language-switcher" class="fixed top-4 right-4 flex items-center space-x-2 bg-white/5 backdrop-blur-sm rounded-full p-1 border border-white/10 z-50">
  <button
    class="language-btn"
    data-lang="ru"
    aria-label="–†—É—Å—Å–∫–∏–π"
  >
    üá∑üá∫ RU
  </button>
  <button
    class="language-btn active"
    data-lang="en"
    aria-label="English"
  >
    üá¨üáß EN
  </button>
</div>

<style>
  .language-btn {
    padding: 6px 12px;
    border-radius: 9999px;
    color: #666;
    font-size: 14px;
    font-weight: 600;
    transition: all 0.2s;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 4px;
  }

  .language-btn.active {
    background: #33FF66;
    color: #001133;
  }

  .language-btn:not(.active):hover {
    color: #fff;
  }
</style>

<script>
  // This client script will run after the DOM is fully loaded
  // Wait for all content to be loaded
  window.addEventListener('load', () => {
    initLanguageSwitcher();
  });

  function initLanguageSwitcher() {
    console.log('Initializing language switcher...');
    
    const translations = {
      ru: {
        hero_title: "–ü—Ä–µ–º–∏–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞<br/>–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –¥–ª—è –∞—Ä–±–∏—Ç—Ä–∞–∂–∞",
        hero_subtitle: "–ú—ã —Å–æ–∑–¥–∞–µ–º –≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –≤–ø–µ—á–∞—Ç–ª—è—é—â–∏–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–º –æ–¥–æ–±—Ä–µ–Ω–∏—è –≤ 90%. –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –¥–∏–∑–∞–π–Ω –∏ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ä–µ—à–µ–Ω–∏—è –¥–ª—è –∫–ª–æ–∞–∫–∏–Ω–≥–∞.",
        pricing_btn: "–¢–∞—Ä–∏—Ñ—ã",
        contact_btn: "–°–≤—è–∑–∞—Ç—å—Å—è",
        features_title_1: "–û–¥–æ–±—Ä–µ–Ω–∏–µ –≤ —Å—Ç–æ—Ä–∞—Ö",
        features_desc_1: "–õ–∏–¥–∏—Ä—É—é—â–∏–π –≤ –∏–Ω–¥—É—Å—Ç—Ä–∏–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ–≥–æ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –º–æ–¥–µ—Ä–∞—Ü–∏–∏",
        features_title_2: "–ü–æ–¥–¥–µ—Ä–∂–∫–∞",
        features_desc_2: "–ö—Ä—É–≥–ª–æ—Å—É—Ç–æ—á–Ω–∞—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤–∞—à–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π",
        features_title_3: "–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –¥–∏–∑–∞–π–Ω",
        features_desc_3: "–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –¥–∏–∑–∞–π–Ω–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è",
        pricing_title: "–¢–∞—Ä–∏—Ñ—ã",
        pricing_subtitle: "–í—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –¥–ª—è –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞",
        basic_plan: "–ë–∞–∑–æ–≤—ã–π",
        premium_plan: "–ü—Ä–µ–º–∏—É–º",
        enterprise_plan: "–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π",
        popular_choice: "–ü–æ–ø—É–ª—è—Ä–Ω—ã–π –≤—ã–±–æ—Ä",
        per_app: "/ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ",
        contact_title: "–°–≤—è–∑–∞—Ç—å—Å—è —Å –Ω–∞–º–∏",
        contact_subtitle: "–û—Å—Ç–∞–≤—å—Ç–µ –∑–∞—è–≤–∫—É, –∏ –º—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è –¥–µ—Ç–∞–ª–µ–π",
        email_label: "Email",
        project_details: "–î–µ—Ç–∞–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞",
        project_placeholder: "–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ –≤–∞—à–µ–º –ø—Ä–æ–µ–∫—Ç–µ...",
        send_btn: "–û—Ç–ø—Ä–∞–≤–∏—Ç—å",
        discuss_project: "–û–±—Å—É–¥–∏—Ç—å –ø—Ä–æ–µ–∫—Ç",
        choose_plan: "–í—ã–±—Ä–∞—Ç—å",
        basic_feature_1: "–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è",
        basic_feature_2: "–ë–∞–∑–æ–≤—ã–π –∫–ª–æ–∞–∫–∏–Ω–≥",
        basic_feature_3: "–ü—É–±–ª–∏–∫–∞—Ü–∏—è –≤ —Å—Ç–æ—Ä–µ",
        basic_feature_4: "–ë—Ä–µ–Ω–¥–∏–Ω–≥",
        premium_feature_1: "–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è",
        premium_feature_2: "–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –∫–ª–æ–∞–∫–∏–Ω–≥",
        premium_feature_3: "–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è",
        premium_feature_4: "–ü—Ä–µ–º–∏—É–º –¥–∏–∑–∞–π–Ω",
        premium_feature_5: "3 –º–µ—Å—è—Ü–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏",
        premium_feature_6: "–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —Ç—Ä–∞—Ñ–∏–∫–∞",
        enterprise_feature_1: "–ú–Ω–æ–∂–µ—Å—Ç–≤–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π",
        enterprise_feature_2: "–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –∫–ª–æ–∞–∫–∏–Ω–≥",
        enterprise_feature_3: "VIP –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤ —Å—Ç–æ—Ä–∞—Ö",
        enterprise_feature_4: "–ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–µ –ø—Ä–∞–≤–∫–∏",
        enterprise_feature_5: "12 –º–µ—Å—è—Ü–µ–≤ –ø–æ–¥–¥–µ—Ä–∂–∫–∏",
        enterprise_feature_6: "White Label"
      },
      en: {
        hero_title: "Premium App Development<br/>for Traffic Arbitrage",
        hero_subtitle: "We create high-quality applications with an impressive 90% approval rate. Custom design and advanced cloaking solutions.",
        pricing_btn: "Pricing",
        contact_btn: "Contact",
        features_title_1: "Store Approval",
        features_desc_1: "Industry-leading moderation success rate",
        features_title_2: "Support",
        features_desc_2: "24/7 technical support and monitoring of your applications",
        features_title_3: "Unique Design",
        features_desc_3: "Custom design development for each application",
        pricing_title: "Pricing",
        pricing_subtitle: "Choose the optimal plan for your project",
        basic_plan: "Basic",
        premium_plan: "Premium",
        enterprise_plan: "Enterprise",
        popular_choice: "Popular Choice",
        per_app: "/ app",
        contact_title: "Contact Us",
        contact_subtitle: "Leave a request and we'll contact you to discuss the details",
        email_label: "Email",
        project_details: "Project Details",
        project_placeholder: "Tell us about your project...",
        send_btn: "Send",
        discuss_project: "Discuss Project",
        choose_plan: "Choose Plan",
        basic_feature_1: "App Development",
        basic_feature_2: "Basic Cloaking",
        basic_feature_3: "Store Publication",
        basic_feature_4: "Branding",
        premium_feature_1: "App Development",
        premium_feature_2: "Advanced Cloaking",
        premium_feature_3: "Priority Publication",
        premium_feature_4: "Premium Design",
        premium_feature_5: "3 Months Support",
        premium_feature_6: "Traffic Analytics",
        enterprise_feature_1: "Multiple Applications",
        enterprise_feature_2: "Custom Cloaking",
        enterprise_feature_3: "VIP Store Support",
        enterprise_feature_4: "Unlimited Revisions",
        enterprise_feature_5: "12 Months Support",
        enterprise_feature_6: "White Label"
      }
    };

    function updateContent(lang) {
      console.log(`Changing language to: ${lang}`);
      const t = translations[lang];
      
      // Update hero section
      const h1 = document.querySelector('h1');
      if (h1) {
        h1.innerHTML = t.hero_title;
        console.log('Updated h1');
      } else {
        console.warn('H1 element not found');
      }
      
      const subtitle = document.querySelector('.hero-subtitle');
      if (subtitle) {
        subtitle.textContent = t.hero_subtitle;
        console.log('Updated subtitle');
      } else {
        console.warn('Subtitle element not found');
      }
      
      // Update all elements with data-i18n attribute
      const i18nElements = document.querySelectorAll('[data-i18n]');
      console.log(`Found ${i18nElements.length} elements with data-i18n`);
      
      i18nElements.forEach(el => {
        const key = el.dataset.i18n;
        if (key && t[key]) {
          if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') {
            el.placeholder = t[key];
          } else {
            el.innerHTML = t[key];
          }
          console.log(`Updated element with key: ${key}`);
        } else {
          console.warn(`Translation missing for key: ${key}`);
        }
      });

      // Update pricing plan features
      const featureElements = document.querySelectorAll('[data-i18n-feature]');
      console.log(`Found ${featureElements.length} elements with data-i18n-feature`);
      
      featureElements.forEach(el => {
        const key = el.dataset.i18nFeature;
        if (key && t[key]) {
          el.textContent = t[key];
          console.log(`Updated feature with key: ${key}`);
        } else {
          console.warn(`Translation missing for feature key: ${key}`);
        }
      });

      // Save language preference to localStorage
      localStorage.setItem('preferredLanguage', lang);
    }

    // Setup language buttons
    const buttons = document.querySelectorAll('.language-btn');
    console.log(`Found ${buttons.length} language buttons`);
    
    if (buttons.length > 0) {
      buttons.forEach(btn => {
        btn.addEventListener('click', (e) => {
          e.preventDefault();
          const lang = btn.dataset.lang;
          console.log(`Button clicked: ${lang}`);
          
          // Visual feedback for the button
          buttons.forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          
          // Update content with new language
          updateContent(lang);
        });
        console.log(`Added click listener to ${btn.dataset.lang} button`);
      });
      
      // Get preferred language from localStorage or use default
      const savedLang = localStorage.getItem('preferredLanguage');
      const defaultLang = savedLang || 'en';
      
      // Set visual state for the active language button
      buttons.forEach(btn => {
        if(btn.dataset.lang === defaultLang) {
          btn.classList.add('active');
        } else {
          btn.classList.remove('active');
        }
      });
      
      // Set initial language
      updateContent(defaultLang);
      console.log(`Set initial language to ${defaultLang}`);
    } else {
      console.error('No language buttons found!');
    }
  }
</script>